{% extends 'base_restaurateur_page.html' %}

{% block title %}–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã | Star Burger{% endblock %}

{% block content %}
<center>
  <h2>–ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h2>
</center>

<hr/>
<br/>
<div class="container">
  <table class="table table-responsive">
    <tr>
      <th>ID –∑–∞–∫–∞–∑–∞</th>
      <th>–°—Ç–∞—Ç—É—Å</th>
      <th>–°–æ–∑–¥–∞–Ω</th>
      <th>–ó–≤–æ–Ω–æ–∫</th>
      <th>–î–æ—Å—Ç–∞–≤–∫–∞</th>
      <th>–ö–ª–∏–µ–Ω—Ç</th>
      <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
      <th>–ê–¥—Ä–µ—Å</th>
      <th>–°—É–º–º–∞</th>
      <th>–°–æ—Å—Ç–∞–≤</th>
      <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
      <th>–°—Å—ã–ª–∫–∞ –Ω–∞ –∞–¥–º–∏–Ω–∫—É</th>
    </tr>
    {% for order in orders %}
    <tr>
      <td>{{ order.id }}</td>
      <td>{{ order.get_status_display }}</td>
      <td>{{ order.created_at|date:"d.m.Y H:i" }}</td>
      <td>{{ order.called_at|date:"d.m.Y H:i"|default:"‚Äî" }}</td>
      <td>{{ order.delivered_at|date:"d.m.Y H:i"|default:"‚Äî" }}</td>
      <td>{{ order.firstname }} {{ order.lastname }}</td>
      <td>{{ order.phonenumber }}</td>
      <td>{{ order.address }}</td>
      <td class="order-price">{{ order.custom_total_price|default:"0.00" }} ‚ÇΩ</td>
      <td class="order-items">
        <ul>
          {% for item in order.items.all %}
          <li>{{ item.product.name }} √ó {{ item.quantity }}</li>
          {% endfor %}
        </ul>
      </td>
      <td class="order-comment">
        {% if order.comment %}
        <details>
          <summary>üìù–ü–æ–∫–∞–∑–∞—Ç—å</summary>
          <div class="comment-bubble">{{ order.comment }}</div>
        </details>
        {% else %}
        ‚Äî
        {% endif %}
      </td>
      <td>
        <a href="{% url 'admin:foodcartapp_order_change' order.id %}?next={{ request.get_full_path|urlencode }}"
           class="edit-link">
          ‚úé–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="12" class="text-muted">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤</td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}

<style>
  .order-price {
    font-weight: 600;
    color: #2e7d32;
    white-space: nowrap;
  }

  .order-comment {
    max-width: 200px;
  }

  .comment-bubble {
    background: #f3f4f6;
    padding: 8px 12px;
    border-radius: 12px;
    margin-top: 4px;
    font-size: 0.9em;
    line-height: 1.4;
  }

  .edit-btn {
    color: #3b82f6;
    text-decoration: none;
    font-size: 1.1em;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s;
  }

  .edit-btn:hover {
    background: #eef2ff;
    text-decoration: none;
  }

  td {
    vertical-align: top;
    padding: 12px 8px !important;
  }

  th {
    background: #f8f9fa;
    position: sticky;
    top: 0;
    box-shadow: 0 2px 2px -1px rgba(0,0,0,0.1);
  }

  .order-items ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
  }

  .order-items li {
    padding: 2px 0;
    font-size: 0.95em;
  }

  details summary {
    cursor: pointer;
    outline: none;
  }

  details summary::-webkit-details-marker {
    display: none;
  }
</style>
