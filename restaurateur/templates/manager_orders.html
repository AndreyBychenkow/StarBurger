{% extends 'base_restaurateur_page.html' %}

{% block title %}Необработанные заказы | Star Burger{% endblock %}

{% block content %}
<center>
  <h2>Необработанные заказы</h2>
</center>

<hr/>
<br/>
<div class="container">
  <table class="table table-responsive">
    <tr>
      <th>ID заказа</th>
      <th>Статус</th>
      <th>Клиент</th>
      <th>Телефон</th>
      <th>Адрес доставки</th>
      <th>Стоимость</th>
      <th>Состав заказа</th>
      <th>Комментарий</th>
      <th>Ссылка на админку</th>
    </tr>
    {% for order in orders %}
    <tr>
      <td>{{ order.id }}</td>
      <td>{{ order.get_status_display }}</td>
      <td>{{ order.firstname }} {{ order.lastname }}</td>
      <td>{{ order.phonenumber }}</td>
      <td>{{ order.address }}</td>
      <td class="order-price">{{ order.custom_total_price|default:"0.00" }} руб.</td>
      <td>
        <ul>
          {% for item in order.items.all %}
          <li>{{ item.product.name }} × {{ item.quantity }}</li>
          {% endfor %}
        </ul>
      </td>
      <td class="order-comment">
        {% if order.comment %}
        <details>
          <summary>Показать</summary>
          <div class="comment-content">{{ order.comment }}</div>
        </details>
        {% else %}
        —
        {% endif %}
      </td>
      <td>
        <a href="{% url 'admin:foodcartapp_order_change' order.id %}?next={{ request.get_full_path|urlencode }}"
           class="edit-link">
          ✎ Редактировать
        </a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="9">Нет необработанных заказов</td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}

<style>
  .order-price {
    font-weight: bold;
    color: #ff4500;
    white-space: nowrap;
  }

  .order-comment {
    max-width: 250px;
    word-wrap: break-word;
  }

  .comment-content {
    padding: 8px;
    background: #f8f9fa;
    border-radius: 4px;
    margin-top: 5px;
  }

  a.edit-link {
    text-decoration: none;
    color: #007bff;
    white-space: nowrap;
  }

  a.edit-link:hover {
    text-decoration: underline;
  }

  details summary {
    cursor: pointer;
    color: #6c757d;
    outline: none;
  }

  details summary:hover {
    color: #007bff;
  }
</style>
